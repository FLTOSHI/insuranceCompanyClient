Что не получается:

Проблема с воспрепятствием входа при неверных данных пользователя.
Роли.