Что не получается:

Проблема с воспрепятствием входа при неверных данных пользователя (проходит вне зависимости от верности).
Роли.